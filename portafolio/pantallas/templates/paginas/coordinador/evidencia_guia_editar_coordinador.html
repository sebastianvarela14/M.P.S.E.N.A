{% extends "plantillacoor.html" %}

{% block contenido %}

<div class="container mt-4 mb-5">
    <h4 class="fw-bold mb-4 text-start">EDITAR EVIDENCIA</h4>

    <div class="card shadow-sm border-0 rounded-3">
        <div class="card-body p-4">
<!-- FORMULARIO PRINCIPAL -->
<form method="POST" enctype="multipart/form-data">
    {% csrf_token %}

    <!-- Título -->
    <div class="mb-3">
        <label class="form-label fw-semibold">Título de la Evidencia</label>
        <input type="text" name="titulo" class="form-control input-anim"
               value="{{ evidencia.titulo }}">
    </div>

    <!-- Instrucciones -->
    <div class="mb-3">
        <label class="form-label fw-semibold">Instrucciones</label>
        <textarea name="instrucciones" class="form-control input-anim" rows="4">{{ evidencia.instrucciones }}</textarea>
    </div>

    <!-- Archivo actual -->
    <div class="mb-3">
        <label class="form-label fw-semibold">Archivo actual</label>

        {% if evidencia.archivo %}
            <div class="d-flex justify-content-between align-items-center p-2 border rounded">
                <span>
                    <i class="bi bi-file-earmark"></i> {{ evidencia.archivo }}
                </span>

                <!-- BOTÓN DE ELIMINAR (sin form aquí) -->
                <button type="button" class="btn btn-sm btn-danger"
                        onclick="document.getElementById('form-delete-file').submit();">
                    <i class="bi bi-trash"></i>
                </button>
            </div>
        {% else %}
            <p class="text-muted">No hay archivo cargado.</p>
        {% endif %}
    </div>

    <!-- Subir nuevo archivo -->
    <div class="mb-3">
        <label class="form-label fw-semibold">Subir nuevo archivo</label>
        <input class="form-control input-anim" type="file" name="archivo">
    </div>

    <!-- Botones -->
    <div class="text-end mt-4">
        <a href="{% url 'evidencia_guia_coordinador' evidencia.id %}" class="btn btn-secondary btn-anim me-2">Cancelar</a>
        <button type="submit" class="btn btn-success btn-anim">
            <i class="bi bi-check-circle me-2"></i> Guardar Cambios
        </button>
    </div>

</form>

<!-- FORM independiente para eliminar archivo -->
<form id="form-delete-file" method="POST" action="{% url 'eliminar_archivo_evidencia' evidencia.id %}">
    {% csrf_token %}
</form>


<style>
.input-anim {
    transition: all 0.3s ease;
    border-radius: 8px;
}
.input-anim:focus {
    border-color: #2e7d32;
    box-shadow: 0 0 6px rgba(46, 125, 50, 0.5);
    transform: scale(1.01);
}
.btn-anim {
    font-weight: 600;
    transition: all 0.3s ease;
}
.btn-anim:hover {
    background-color: #1b5e20 !important;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
}
</style>

{% endblock %}
